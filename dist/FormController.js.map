{"version":3,"sources":["../src/FormController.js"],"names":["util","$","Widget","isInputSelector","indexOf","type","FormController","opt","EVE_INPUT","getEveNameInput","$container","blurChk","statMark","defFormData","dataFilter","chkVal","errMsg","mapHintTargetName","oriName","formNames","Object","keys","formdata","reduce","o","name","val","undefined","String","_chkStatus","_o","_uid","Math","random","_bindEve","$allInput","find","$allErrCont","$allBlock","setTimeout","_syncViewData","_syncModelToView","that","isNotDef","runSet","value","chkOne","loose","each","checked","names","forEach","filter","prop","split","scope","length","chkAll","useCache","updateChk","Promise","all","map","status","then","flg","updData","hideErr","_cleanChk","debug","console","log","data","host","key","func","pass","chkAllSetting","chk","showErr","item","chkOneSetting","getDom","addClass","rules","msg","_isChked","rtn","resolve","rule","hasOwnProperty","flag","action","_handleTempHideErr","html","css","removeClass","i","iptChecked","get","join","isOnComposition","isChrome53plus","getChromeVer","handleChange","e","_gatherValue","trigger","dom","deBounceHandleInput","debounceDo","handleInput","_tempHideErr","_filterChangedData","handleComposition","call","handleBlur","handleFocus","handleSubmit","preventDefault","isLoading","handleContainerKeydown","keyCode","lastI","target","eq","focus","handleAfterInput","info","_blockDecoHasV","_tar","on","off"],"mappings":"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","file":"FormController.js","sourcesContent":["/**\n * 表单数据验证功能\n */\n\nimport * as util from './util/';\nconst { $, Widget } = util;\n\nconst isInputSelector = type => !!~'radio,checkbox'.indexOf(type);\n\nclass FormController extends Widget {\n  constructor(opt) {\n    super(opt);\n    this.EVE_INPUT = util.getEveNameInput();\n    this.opt = opt = {\n      // 容器\n      $container: null,\n      // 失焦就检测\n      blurChk: true,\n\n      // 用户输入交互，如聚焦失焦，错误，空值\n      statMark: true,\n\n      // 默认的表单数据，就算是空的也要加上去。\n      defFormData: {\n        /*\n          name: '',\n          mobile: '',\n        */\n      },\n\n      // 实时控制用户输入的数据\n      dataFilter: {\n        /*\n          mobile: val => val.replace(/[^\\d]/g, '').slice(0, 11),\n        */\n      },\n\n      // 数据验证\n      chkVal: {\n        /*\n          name: {\n            require: (val,next) => {\n                next(val.length > 0)\n            },\n            max: val => val.length < 11\n          },\n          mobile: {\n            require: val => /^1\\d{10}$/.test(val)\n          },\n        */\n      },\n\n      // 错误提示文案\n      errMsg: {\n        /*\n          name: {\n            require: '请填写收件人',\n            max:'收件人请限制10个字以内'\n          },\n          mobile: {\n            require: '请填写正确的联系电话'\n          },\n        */\n      },\n      mapHintTargetName: oriName => oriName,\n      ...opt\n    };\n\n    this.formNames = Object.keys(opt.defFormData);\n\n    this.formdata = this.formNames.reduce((o, name) => {\n      let val = opt.defFormData[name];\n      if (val === null || val === undefined) {\n        val = '';\n      }\n      o[name] = String(val);\n      return o;\n    }, {});\n\n    // 1. undefined 表示没有检查过，\n    // 2. Promise:\n    //      1. null 表示检查通过，\n    //      2. { msg, name} 表示有错误;\n\n    this._chkStatus = this.formNames.reduce((_o, name) => {\n      _o[name] = undefined;\n      return _o;\n    }, {});\n\n    this._uid = (Math.random() * 1e5) | 0;\n\n    opt.$container = $(opt.$container);\n\n    this._bindEve();\n\n    this.$allInput = opt.$container.find('input[name],textarea[name]');\n    this.$allErrCont = opt.$container.find('span.err');\n    this.$allBlock = opt.$container.find('[data-block]');\n    setTimeout(() => {\n      // 获取浏览器自动填充的数据（假如对应的formdata为空）\n      this._syncViewData();\n      // 把formdata更新到视图\n      this._syncModelToView();\n    }, 0);\n  }\n  _syncViewData() {\n    const that = this;\n    const isNotDef = name => this.formdata[name] === '';\n    const runSet = (name, value) => {\n      that.formdata[name] = value;\n      that.chkOne(name, { loose: true });\n    };\n\n    this.$allInput.each(function() {\n      if (isInputSelector(this.type)) {\n        if (this.checked && isNotDef(this.name)) {\n          runSet(this.name, this.value);\n        }\n      } else if (this.value && isNotDef(this.name)) {\n        runSet(this.name, this.value);\n      }\n    });\n  }\n  _syncModelToView(names, opt) {\n    if (!names) names = this.formNames;\n    if (typeof names === 'string') names = [names];\n\n    names.forEach(name => {\n      // 表单数据一定是要字符串\n      const val = this.formdata[name];\n\n      // 空数据不需要同步\n      if (!val && opt !== 'focus') return;\n\n      this.$allInput.filter(`[name=\"${name}\"]`).each(function() {\n        if (isInputSelector(this.type)) {\n          //debugger\n          $(this).prop('checked', !!~val.split(',').indexOf(this.value));\n        } else {\n          this.value = val;\n        }\n      });\n    });\n  }\n  getChkStatus(...scope) {\n    if (!scope.length) {\n      this.chkAll({ useCache: true });\n      scope = Object.keys(this._chkStatus);\n    } else {\n      scope.forEach(name => this.updateChk(name));\n    }\n\n    return Promise.all(\n      scope.map(name => {\n        const status = this._chkStatus[name];\n\n        if (status instanceof Promise) {\n          return status.then(flg => flg === null);\n        } else {\n          return false;\n        }\n      })\n    );\n  }\n  //给实例调用，以更新错误提示，（如用户未输入任何内容的时候）\n  updateChk(name) {\n    this.chkOne(name, {\n      useCache: true\n    });\n  }\n  updateData(name, val) {\n    return this.updData(name, val);\n  }\n  updData(name, val, opt) {\n    this.hideErr(name);\n\n    this.formdata[name] = val;\n    //清除检查结果。\n    this._cleanChk(name);\n\n    opt !== 'noSyncToView' && this._syncModelToView(name, 'focus');\n\n    if (this.opt.blurChk) {\n      this.chkOne(name, { loose: true, useCache: true });\n    }\n    this.opt.debug && console.log(name, val);\n  }\n  _filterChangedData(data) {\n    return Object.keys(data).reduce((host, key) => {\n      const func = this.opt.dataFilter[key];\n      host[key] = func ? func(data[key]) : data[key];\n      return host;\n    }, {});\n  }\n  /**\n   * 清楚检测结果\n   * @this._chkStatus[name]\n   *      Promise instance： pending 等待异步结果\n   *      null:表示检查通过，\n   *      undefined: 表示没有检查过，\n   *      { msg, name}: 表示有错误\n   * @param name  form name\n   */\n  _cleanChk(name) {\n    this._chkStatus[name] = undefined;\n  }\n  /**\n   * 查看是否【已经或正在】检查用户的最新输入\n   * @returns {boolean}\n   */\n  _isChked(name) {\n    const status = this._chkStatus[name];\n\n    return status instanceof Promise;\n  }\n  async chkAll(opt, pass) {\n    const chk = await this.chkAllSetting(opt);\n\n    if (chk.length < 1) return pass();\n\n    if (chk.length > 0) {\n      chk.forEach(item => this.showErr(item));\n    }\n  }\n  async chkOne(name, opt = {}, pass) {\n    const chk = await this.chkOneSetting(name, opt);\n\n    switch (chk) {\n      case null:\n        this.opt.statMark && this.getDom('block', name).addClass('b-has-pass');\n        // through\n      case undefined:\n        pass && pass();\n        break;\n      default:\n        this.showErr(chk);\n    }\n  }\n  async chkOneSetting(name, opt = {}) {\n    let val = this.formdata[name];\n    const rules = this.opt.chkVal[name] || {};\n    const msg = this.opt.errMsg[name] || {};\n\n    // 使用缓存的情况\n    if (opt.useCache && this._isChked(name)) {\n      return await this._chkStatus[name];\n    }\n\n    // 删除之前检查结果的缓存，避免异步时候出现混乱\n    this._cleanChk(name);\n\n    // 不严格的检测。当用户未输入时，不提示错误\n    if (opt.loose && !val) {\n      return undefined;\n    }\n\n    let rtn = null;\n\n    return (this._chkStatus[name] = new Promise(async resolve => {\n      for (let rule in rules) {\n        if (!rules.hasOwnProperty(rule)) continue;\n        // 区分异步还是同步\n        const func = rules[rule];\n\n        try {\n          const flag = await func(val);\n\n          if (!flag) {\n            rtn = {\n              msg: msg[rule],\n              name\n            };\n            break;\n          }\n        } catch (e) {\n          rtn = {\n            msg: e,\n            name\n          };\n          break;\n        }\n      }\n      resolve(rtn);\n    }));\n  }\n  async chkAllSetting(opt = {}) {\n    return (await Promise.all(\n      Object.keys(this.formdata).map(async name => {\n        return await this.chkOneSetting(name, opt);\n      })\n    )).filter(item => item !== null);\n  }\n  // 获取或设置该name是否暂时隐藏了错误提示。\n  _handleTempHideErr(name, action) {\n    if (typeof action === 'undefined') return !!this[`_tempHideErr_${name}`];\n    this[`_tempHideErr_${name}`] = action;\n  }\n  showErr(item) {\n    this._handleTempHideErr(item.name, false);\n\n    const name = this.opt.mapHintTargetName(item.name);\n\n    this.getDom('err', name)\n      .html(item.msg)\n      .css('display', 'block');\n    this.getDom('err', 'submit').css('display', 'block');\n    this.opt.statMark && this.getDom('block', name).removeClass('b-has-pass').addClass('b-has-err');\n  }\n  hideErr(name, opt) {\n    this._handleTempHideErr(name, opt === 'temp');\n\n    name = this.opt.mapHintTargetName(name);\n    this.getDom('err', name).css('display', 'none');\n    this.getDom('err', 'submit').css('display', 'none');\n    this.opt.statMark && this.getDom('block', name).removeClass('b-has-err');\n  }\n  getDom(type, name) {\n    if (type === 'block') {\n      if (this) return this.$allBlock.filter(`[data-block=\"${name}\"]`);\n    } else if (type === 'err') {\n      return this.$allErrCont.filter(`[data-for=\"${name}\"]`);\n    } else {\n      return $();\n    }\n  }\n  _gatherValue({ type, value: val, name }) {\n    if (type === 'checkbox') {\n      // 提取checkbox 的所有值\n      val = this.$allInput\n        .filter(`[name=\"${name}\"]:checked`)\n        .map(function(i, iptChecked) {\n          return iptChecked.value;\n        })\n        .get()\n        .join(',');\n    }\n\n    return { name, val };\n  }\n  _bindEve() {\n    const that = this;\n    let isOnComposition = false;\n    // fixed for Chrome v53+ and detect all Chrome\n    // https://chromium.googlesource.com/chromium/src/\n    // +/afce9d93e76f2ff81baaa088a4ea25f67d1a76b3%5E%21/\n    const isChrome53plus = util.getChromeVer() > 52;\n\n    //失焦后假如有变化\n    const handleChange = function(e) {\n      const { val, name } = that._gatherValue(this);\n\n      that.updData(name, val, 'noSyncToView');\n\n      that.trigger('input', {\n        name,\n        val,\n        dom: this\n      });\n    };\n\n    const deBounceHandleInput = util.debounceDo(50);\n    //输入框 即时触发\n    const handleInput = function() {\n      //输入时，把对应的错误提示隐藏\n      if (!this._tempHideErr) {\n        that.hideErr(this.name, 'temp');\n      }\n      this._tempHideErr = true;\n\n      if (isOnComposition) return;\n\n      //筛选输入的数据\n      deBounceHandleInput(() => {\n        //筛选\n        const data = that._filterChangedData({ [this.name]: this.value });\n\n        //解决输入法的问题。\n        if (data[this.name] !== this.value) {\n          this.value = data[this.name];\n        }\n\n        that.trigger('input', {\n          name: this.name,\n          val: this.value,\n          dom: this\n        });\n      });\n    };\n\n    // 输入法事件\n    const handleComposition = function(e) {\n      isOnComposition = e.type !== 'compositionend';\n\n      if (!isOnComposition && isChrome53plus) {\n        handleInput.call(this, e);\n      }\n    };\n\n    const handleBlur = function() {\n      this._tempHideErr = false;\n      //\n      if (that._handleTempHideErr(this.name)) {\n        that.updateChk(this.name);\n      }\n\n      //\n      that.opt.statMark &&\n        that.getDom('block', this.name).removeClass('b-has-focus');\n    };\n    const handleFocus = function() {\n      that.opt.statMark &&\n        that.getDom('block', this.name).addClass('b-has-focus');\n    };\n\n    const handleSubmit = function(e) {\n      e && e.preventDefault();\n      if (that.isLoading) return;\n\n      that.chkAll({ useCache: that.opt.blurChk }, () => {\n        that.trigger('submit', that.formdata);\n      });\n    };\n\n    const handleContainerKeydown = function(e) {\n      if (e.keyCode === 13) {\n        const lastI = that.$allInput.length - 1;\n        that.$allInput.each(function(i) {\n          if (this === e.target) {\n            if (i === lastI) {\n              if (e.target.type === 'textarea') return;\n              handleSubmit();\n            } else {\n              that.$allInput.eq(i + 1).focus();\n            }\n          }\n        });\n      }\n    };\n    const handleAfterInput = function(info) {\n      //当有值, 加样式\n      if (info.val !== '' && info.dom._blockDecoHasV !== true) {\n        info.dom._blockDecoHasV = true;\n        this.getDom('block', info.name).addClass('b-has-v');\n      } else if (info.val === '' && info.dom._blockDecoHasV !== false) {\n        info.dom._blockDecoHasV = false;\n        this.getDom('block', info.name).removeClass('b-has-v');\n      }\n    };\n\n    const _tar = 'input,textarea';\n    this.opt.$container\n      .on('keydown.' + this._uid, handleContainerKeydown)\n      .on('change.' + this._uid, _tar, handleChange)\n      //.on('change' + '.' + this._uid, 'input[type=\"radio\"]', handleInput)\n      .on(this.EVE_INPUT + '.' + this._uid, _tar, handleInput)\n      .on('compositionstart' + '.' + this._uid, _tar, handleComposition)\n      .on('compositionupdate' + '.' + this._uid, _tar, handleComposition)\n      .on('compositionend' + '.' + this._uid, _tar, handleComposition)\n      .on('blur.' + this._uid, _tar, handleBlur)\n      .on('focus.' + this._uid, _tar, handleFocus)\n      .on('click.' + this._uid, '[data-action=\"submit\"]', handleSubmit);\n\n    // 样式控制\n    this.opt.statMark && this.on('input', handleAfterInput);\n    //\n  }\n  destory() {\n    this.opt.$container\n      .off('change.' + this._uid)\n      .off(this.EVE_INPUT + '.' + this._uid)\n      .off('blur.' + this._uid)\n      .off('click.' + this._uid);\n\n    this.off('input').off('submit');\n  }\n}\nexport default FormController;\n"]}